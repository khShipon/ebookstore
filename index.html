<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>E-books Store</title>
  <link rel="stylesheet" href="./assets/style.css" />
</head>
<body>
  <header class="header">
    <a href="./index.html" class="logo">E-book Store</a>
    <nav class="navbar">
      <ul>
        <li><a href="./index.html">Home</a></li>
        <li><a href="#">About</a></li>
        <li><a href="#">Contact</a></li>
      </ul>
    </nav>
  </header>
  <main>
    <section class="grid" id="products"></section>
    <p id="msg" style="text-align:center"></p>
  </main>
  <footer class="footer">
    <p>&copy; 2025 E-book Store. All rights reserved.</p>
  </footer>
  <script>
    // SET THIS: your Apps Script web app URL
    const API = 'https://script.google.com/macros/s/AKfycbxPCD0UUiPsUukRzwsP9BMZzJM3_J0J5SlLsDv_ES0o19Ol2ceurZit3HftBITI4Z9I/exec'; // e.g. https://script.google.com/.../exec

    async function loadProducts(){
      try {
        const res = await fetch(`${API}?path=products`);
        const json = await res.json();
        const products = json.products || [];
        const wrap = document.getElementById('products');
        if (products.length === 0) { wrap.innerHTML = '<p>No products available.</p>'; return; }
        wrap.innerHTML = products.map(p => `
          <article class="card">
            <img src="${p.ImageURL||'https://picsum.photos/seed/ebook/640/360'}" alt="${p.Name}"/>
            <div class="p">
              <h3>${p.Name}</h3>
              <p>${p.Description || ''}</p>
              <p><strong>$${p.Price}</strong></p>
              <a class="btn" href="./checkout.html?pid=${encodeURIComponent(p.ID)}">Buy now</a>
            </div>
          </article>
        `).join('');
      } catch (err) {
        document.getElementById('msg').textContent = 'Failed to load products.';
      }
    }

    loadProducts();
  </script>
</body>
</html>